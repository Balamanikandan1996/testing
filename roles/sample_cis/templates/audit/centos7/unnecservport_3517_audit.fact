#!/bin/bash

#  3.5.1.7 - Ensure unnecessary services and ports are not accepted (Scored)

var=$(firewall-cmd --get-active-zones | awk '!/:/ {print $1}' | while read ZN; do firewall-cmd --list-all --zone=$ZN; done)

if [ $(echo "$var" | grep '<service>' | wc -l) -eq 1 ] || [ $(echo "$var" | grep '<portnumber>' | wc -l) -eq 1 ]; then
        echo "{ \"3.5.1.7 - unnecessary services and ports are accepted\"   :  \"FAILED\"}"

else
        echo "{ \"unnecservport_3517_audit\"  :  \"PASSED\"}"
fi
